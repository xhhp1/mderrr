<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>๐ผุงูุดุคูู ุงูุฅุฏุงุฑูุฉ๐ผ</title>
<style>
  :root{
    --gold:#e0ca51;
    --bg:#222;
    --panel-bg: rgba(0,0,0,0.85);
  }
  html,body{height:100%}
  body{
    margin:0;
    font-family: Tahoma, Arial, sans-serif;
    background: url("https://raw.githubusercontent.com/xhhp1/mechanics/main/images/mechan.png") no-repeat center center fixed;
    background-size: cover;
    color:var(--gold);
    text-align:center;
    padding:20px;
    box-sizing:border-box;
  }
  h1{ margin:12px 0 18px; font-size:28px; }

  /* โ ุงููุงุฆูุฉ ูููู ููู */
  .menu{
    position: fixed;
    top: 16px;
    right: 16px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    z-index: 10000;
    margin: 0;
  }

  .menu button{
    padding: 12px 16px;
    font-size: 16px;
    background: var(--gold);
    color: #111;
    border: none;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
    transition: transform .12s ease, background .12s ease;
    min-width: 210px;
    text-align: right;
    box-shadow: 0 6px 18px rgba(0,0,0,0.35);
  }

  .menu button:hover{
    background:#c6b142;
    transform: translateX(-3px);
  }

  /* โ ุฃูู ุชุนุฏูู: ุงุฎูุงุก ูู ุงูุชุงุจุงุช ุงูุชุฑุงุถูุงู */
  .container{
    display:none;
    max-width:980px;
    margin: 12px auto;
    background: var(--panel-bg);
    border-radius:12px;
    padding:18px;
    text-align:right;
    box-sizing:border-box;

    /* ุนุดุงู ุงููุญุชูู ูุง ูุฎุชูู ุชุญุช ุงูููููู */
    margin-top: 90px;
  }
  .container.active{ display:block; }
  .container h2{ margin-top:0; color:var(--gold); }

  label{ display:block; margin:10px 0 6px; font-weight:bold; text-align:right; }
  input[type="text"], input[type="number"], input[type="date"], select, textarea{
    width:100%; padding:10px; border-radius:8px; border:1px solid var(--gold);
    background:var(--bg); color:var(--gold); font-size:15px; box-sizing:border-box;
  }
  textarea{ resize:vertical; }

  .time-group{ display:flex; gap:8px; }
  .time-group input, .time-group select{ flex:1; }

  .manual-wrap{ display:flex; align-items:center; gap:8px; margin-top:8px; }
  .manual-wrap input[type="checkbox"]{ width:auto; }

  .button-row{ display:flex; gap:12px; justify-content:center; margin-top:14px; flex-wrap:wrap; }
  .btn{ padding:12px 22px; background:var(--gold); color:#111; border:none; border-radius:8px; font-weight:bold; cursor:pointer; }
  .btn:hover{ background:#c6b142; }

  .output{
    display:none; margin-top:14px; background:#333; padding:14px; border-radius:8px;
    color:var(--gold); text-align:left; white-space:pre-wrap; direction:ltr;
    max-width:940px; margin-left:auto; margin-right:auto; box-sizing:border-box;
  }

  .custom-dropdown{ position:relative; user-select:none; }
  .cd-selected{
    display:flex; align-items:center; justify-content:space-between; gap:8px;
    padding:10px; border-radius:8px; border:1px solid var(--gold);
    background:var(--bg); color:var(--gold); cursor:pointer;
  }
  .cd-selected .placeholder{ opacity:0.8; }
  .cd-panel{
    position:absolute; z-index:9999; left:0; right:0; top:calc(100% + 6px);
    background:var(--bg); border:1px solid rgba(224,202,81,0.15); border-radius:8px;
    box-shadow:0 6px 20px rgba(0,0,0,0.5); max-height:300px; overflow:auto; padding:6px; display:none;
  }
  .cd-option{ padding:10px; border-radius:6px; color:var(--gold); cursor:pointer; text-align:right; }
  .cd-option:hover{ background: rgba(224,202,81,0.06); }
  .cd-option.selected{ background: rgba(224,202,81,0.14); }

  .checkbox-group{
    display:flex;
    flex-direction:column;
    gap:6px;
    padding:8px 10px;
    border-radius:8px;
    border:1px solid rgba(224,202,81,0.5);
    background:rgba(0,0,0,0.35);
  }
  .checkbox-group label{
    margin:0;
    font-weight:normal;
    display:flex;
    align-items:center;
    gap:6px;
  }
  .checkbox-group input[type="checkbox"]{ width:auto; }

  @media (max-width:720px){
    .menu button{ padding:14px 18px; font-size:18px; min-width:140px; }
    .cd-panel{ max-height:260px; }
  }
</style>
</head>
<body>

<h1>๐ ุงูุดุคูู ุงูุฅุฏุงุฑูุฉ๐</h1>

<div class="menu">
  <button onclick="show('vacBox')">ุงูุฅุฌุงุฒุงุช</button>
  <button onclick="show('secBox')">ุงูุงูุชุฏุงุจุงุช</button>
  <button onclick="show('resignBox')">ุงูุงุณุชูุงูุฉ</button>
  <button onclick="show('accResignBox')">ุงุณุชูุงูุฉ ุงููุนุชูุฏ</button>
  <button onclick="show('violBox')">ุงููุฎุงููุงุช</button>
  <button onclick="show('absBox')">ููู ูู ูุญุถุฑ</button>
  <button onclick="show('extBox')">ุฅุฌุงุฒุฉ ุฎุงุฑุฌูุฉ</button>
  <button onclick="show('roleBox')">ุทูุจ ุฑูู</button>
  <button onclick="show('ticketBox')">ููุงุฐุฌ ุงูุชูุงุช</button>
</div>

<!-- ================= VACATION (ุฅุฌุงุฒุงุช ููุท) ================= -->
<div id="vacBox" class="container">
  <h2>๐งณ ุงูุฅุฌุงุฒุงุช ุงูุฏุงุฎููุฉ ๐งณ</h2>

  <label>ุงูุฅุฌุงุฒุฉ ูููุ</label>
  <select id="vac_vacType" onchange="vac_toggleFields()">
    <option value="ููู">ููู</option>
    <option value="ูุดุฑู">ูุดุฑู</option>
    <option value="ููุงูุฃุฉ ููุงุฏูุฉ">ููุงูุฃุฉ ููุงุฏูุฉ</option>
    <option value="ุฅุฌุงุฒุฉ ูุชููุฒ ุงูุฃุณุจูุน">ุฅุฌุงุฒุฉ ูุชููุฒ ุงูุฃุณุจูุน</option>
    <option value="ุฅุฌุงุฒุฉ ุชุงุฌุฑ">ุฅุฌุงุฒุฉ ุชุงุฌุฑ</option>
  </select>

  <div id="vac_internalFields">
    <div id="vac_leadHeaderBox" style="display:none">
      <label>ุงููุฎุงุทูุจ ูู ุงูุฑุณุงูุฉ</label>
      <select id="vac_leadHeader">
        <option value="">ุงุฎุชุฑ ุงูููุงูุฃุฉ ูููุ</option>
        <option value="ุงููุดุฑู ุงููุญุชุฑู">ุงููุดุฑู ุงููุญุชุฑู</option>
        <option value="ุงูููู ุงููุญุชุฑู">ุงูููู ุงููุญุชุฑู</option>
      </select>
    </div>

    <label>ุงูููุจู ุงูุฏู</label>
    <input type="number" id="vac_copyId" placeholder="ุฃุฏุฎู ุงูููุจู ุงูุฏู">

    <label>ุงููููููุฏุฉ (ุจุงูุณุงุนุงุช)</label>
    <input type="number" id="vac_duration" placeholder="ุนุฏุฏ ุงูุณุงุนุงุช">

    <label id="vac_balanceLabel">ุงูุฑุตูุฏ ุงููุชุจูู (ุจุงูุณุงุนุงุช)</label>
    <input type="number" id="vac_balance" placeholder="ุนุฏุฏ ุงูุณุงุนุงุช">

    <div class="manual-wrap">
      <input type="checkbox" id="vac_manualTime" onchange="vac_toggleManualTime()">
      <label for="vac_manualTime" style="margin:0;font-weight:normal">ูุฅุฏุฎุงู ุงูููุช ุจุดูู ูุฏูู</label>
    </div>
    <div id="vac_timeRow" class="time-group" style="display:none">
      <input type="number" id="vac_startHour" placeholder="ุงูุณุงุนุฉ (1-12)">
      <input type="number" id="vac_startMinute" placeholder="ุงูุฏูููุฉ (0-59)">
      <select id="vac_startPeriod">
        <option value="ุต">ุตุจุงุญูุง</option>
        <option value="ู">ูุณุงุกู</option>
      </select>
    </div>
  </div>

  <div class="button-row">
    <button class="btn" onclick="vac_generateVacation()">ุฅูุดุงุก ุงูุฅุฌุงุฒุฉ</button>
    <button class="btn" onclick="vac_copyResult()">๐ ูุณุฎ ุงููุชูุฌุฉ</button>
  </div>

  <div id="vac_output" class="output"></div>
</div>

<!-- ================= SECONDMENT (ุงูุงูุชุฏุงุจุงุช) ================= -->
<div id="secBox" class="container">
  <h2>๐งพ ููุงุฐุฌ ุงูุงูุชุฏุงุจุงุช ๐งพ</h2>

  <label>ุงูููุจู ุงูุฏู</label>
  <input type="number" id="sec_copyId" placeholder="ุฃุฏุฎู ุงูููุจู ุงูุฏู">

  <label>ุงุณู ุงูููุชุฏุจ ู ููุฏู</label>
  <input type="text" id="sec_nameCode" placeholder="ุงูุชุจ ุงูุงุณู ูุงูููุฏ">

  <label>ุงููุทุงุน ุงูููุชุฏุจ ูู</label>
  <select id="sec_sector">
    <option value="">ุงุฎุชุฑ ุงููุทุงุน</option>
    <option>ุขูู ุงูุทุฑู</option>
    <option>ุขูู ุงูููุดุขุช</option>
    <option>ุญุฑุณ ุงูุญุฏูุฏ</option>
    <option>ุงูููุงู ุงูุฃุญูุฑ</option>
    <option>ุขูู ุนุงู</option>
    <option>ููุงุช ุงูุทุคุงุฑุฆ</option>
  </select>

  <label>ุงููุฏุฉ (ุจุงูุฃูุงู)</label>
  <input type="number" id="sec_days" placeholder="ุนุฏุฏ ุงูุฃูุงู">

  <div class="button-row">
    <button class="btn" onclick="sec_generate()">ุฅูุดุงุก ุงูุงูุชุฏุงุจ</button>
    <button class="btn" onclick="sec_copy()">๐ ูุณุฎ ุงููุชูุฌุฉ</button>
  </div>

  <div id="sec_output" class="output"></div>
</div>

<!-- ================= RESIGNATION (ุงูุงุณุชูุงูุฉ) ================= -->
<div id="resignBox" class="container">
  <h2>๐ูููุฐุฌ ุงูุงุณุชูุงูุฉ๐</h2>

  <label>ุงุณุชูุงูุฉ ููู ุ</label>
  <select id="res_type" onchange="res_toggleLevel()">
    <option value="ูุณุชูู ูุชุฏุฑุจ">ูุณุชูู ูุชุฏุฑุจ</option>
    <option value="ูุณุชูู 1">ูุณุชูู 1</option>
    <option value="ุงุนูู">ูุณุชูู 2 ูุฃุนูู</option>
    <option value="supervisor_4_6">ุงุณุชูุงูุฉ ูุดุฑู ูู 4-6</option>
    <option value="retire_7_9">ุชูุงุนุฏ ูุณุชูู 7-9</option>
  </select>

  <label>ุงูููุจู ุงูุฏู</label>
  <input type="number" id="res_copyId" placeholder="ุฃุฏุฎู ุงูููุจู ุงูุฏู">

  <div id="res_levelBox" style="display:none">
    <label id="res_levelLabel">ุฑูู ุงููุณุชูู</label>
    <input type="number" id="res_levelNumber" placeholder="ุฃุฏุฎู ุฑูู ุงููุณุชูู">
  </div>

  <label>ุงุณู ู ููุฏ (ูุชุงุจุฉ)</label>
  <input type="text" id="res_nameCode" placeholder="ุงูุชุจ ุงูุงุณู ูุงูููุฏ ูุชุงุจุชุงู">

  <label>ููุจู ุงูุฏู (ุงูุชูููุน)</label>
  <input type="number" id="res_supervisorId" placeholder="ุฃุฏุฎู ููุจู ุงูุฏู (ุชูููุน)">

  <div class="button-row">
    <button class="btn" onclick="res_generate()">ุฅูุดุงุก ุงูุฑุณุงูุฉ</button>
    <button class="btn" onclick="res_copy()">๐ ูุณุฎ ุงููุชูุฌุฉ</button>
  </div>
  <div id="res_output" class="output"></div>
</div>

<!-- ================= NEW: ACCREDITED RESIGNATION (ุงุณุชูุงูุฉ ุงููุนุชูุฏ) ================= -->
<div id="accResignBox" class="container">
  <h2>โ ุงุณุชูุงูุฉ ุงููุนุชูุฏ โ</h2>

  <label>ููุน ุงูุงุณุชูุงูุฉ</label>
  <select id="acc_type" onchange="acc_toggleLevel()">
    <option value="trainee_1">ุงุณุชูุงูุฉ ุจูุณุชูู (ูุชุฏุฑุจ & 1)</option>
    <option value="level_2_3">ูุณุชูู 2 ู 3</option>
  </select>

  <label>ููุดู ูููุนุชูุฏ (ุงูููุจู ุงูุฏู)</label>
  <input type="number" id="acc_copyId" placeholder="ุฃุฏุฎู ููุจู ุงูุฏู ุงููุนุชูุฏ">

  <div id="acc_levelBox" style="display:none">
    <label id="acc_levelLabel">ุฑูู ุงููุณุชูู (2 ุฃู 3)</label>
    <input type="number" id="acc_levelNumber" placeholder="ุงูุชุจ 2 ุฃู 3 ููุท">
  </div>

  <label>ุงุณู ู ููุฏ ุงููุนุชูุฏ (ูุชุงุจุฉ)</label>
  <input type="text" id="acc_nameCode" placeholder="ูุซุงู:  ุญูููุฏ ุจูู ุนูุณูููุฑ [CC|G-020]">

  <label> ููุดู ูููุณู </label>
  <input type="number" id="acc_selfId" placeholder="ุฃุฏุฎู ููุจู ุงูุฏู (ููุดู ูููุณู)">

  <label>ูุณุคูู ูู ุงุนุทุงุก ุงูุงุฐู </label>
  <input type="number" id="acc_permissionId" placeholder="ุงูุชุจ ููุจู ุงูุฏู ูุณุคูู ุงุนุทุงุก ุงูุงุฐู">

  <div class="button-row">
    <button class="btn" onclick="acc_generate()">ุฅูุดุงุก</button>
    <button class="btn" onclick="acc_copy()">๐ ูุณุฎ</button>
  </div>

  <div id="acc_output" class="output"></div>
</div>

<!-- ================= VIOLATIONS (ุงููุฎุงููุงุช) ================= -->
<div id="violBox" class="container">
  <h2>๐ุงููุฎุงููุงุช๐</h2>

  <label>ุงูููุจู ุงูุฏู</label>
  <input type="number" id="vio_copyId" placeholder="ุฃุฏุฎู ุงูููุจู ุงูุฏู">

  <label>ุฑูู ุงูุฅูุฐุงุฑ ุงููุธููู</label>
  <select id="vio_warningLevel" onchange="vio_toggleByLevel()">
    <option value="ุดููู">ุดููู</option>
    <option value="ุงูู">ุงูู</option>
    <option value="ุซุงูู">ุซุงูู</option>
    <option value="ููุงุฆู">ููุงุฆู</option>
  </select>

  <div id="vio_fineRow">
    <label>ูููุฉ ุงูุบุฑุงูุฉ</label>
    <input type="number" id="vio_fineAmount" placeholder="ุฃุฏุฎู ูููุฉ ุงูุบุฑุงูุฉ">
  </div>

  <div id="vio_supervisorRow">
    <label>ููุจู ุงูุฏู ุงููุดุฑู</label>
    <input type="number" id="vio_supervisorId" placeholder="ุฃุฏุฎู ููุจู ุงูุฏู ุงููุดุฑู">
  </div>

  <label>ุงููุฎุงููุงุช</label>
  <div class="custom-dropdown" id="vio_dropdown">
    <div class="cd-selected" onclick="toggleDropdown('vio')">
      <span class="placeholder">ุงุฎุชุฑ ุงููุฎุงููุฉ</span>
      <span>&#9662;</span>
    </div>
    <div class="cd-panel" id="vio_panel" role="listbox" aria-hidden="true"></div>
  </div>
  <input type="hidden" id="vio_selected" value="">

  <div class="button-row">
    <button class="btn" onclick="vio_generate()">ุฅูุดุงุก ุงูุฅูุฐุงุฑ</button>
    <button class="btn" onclick="vio_copy()">๐ ูุณุฎ ุงููุชูุฌุฉ</button>
  </div>

  <div id="vio_output" class="output"></div>
</div>

<!-- ================= ABSENT (ููู ูู ูุญุถุฑ) ================= -->
<div id="absBox" class="container">
  <h2>๐งฒูููุฐุฌ ุฅุณุชุฏุนุงุก ููููู ุงูุฐู ูู ูุญุถุฑ๐งฒ</h2>

  <label>ุงูููุจู ุงูุฏู:</label>
  <input type="number" id="abs_copyId" placeholder="ุฃุฏุฎู ุงูููุจู ุงูุฏู">

  <label>ุณุจุจ ุงูุงุณุชุฏุนุงุก:</label>
  <div class="custom-dropdown" id="abs_dropdown">
    <div class="cd-selected" onclick="toggleDropdown('abs')">
      <span class="placeholder">ุงุฎุชุฑ ุงูุณุจุจ</span>
      <span>&#9662;</span>
    </div>
    <div class="cd-panel" id="abs_panel" role="listbox" aria-hidden="true"></div>
  </div>
  <input type="hidden" id="abs_selected" value="">

  <label>ูููุฉ ุงููุฎุงููุฉ:</label>
  <input type="number" id="abs_penalty" placeholder="ุฃุฏุฎู ูููุฉ ุงููุฎุงููุฉ">

  <label>ุงูุฅูุฐุงุฑ ุงููุณุชุญูุ</label>
  <select id="abs_warning">
    <option value="">ุงุฎุชุฑ ุงูุฅูุฐุงุฑ</option>
    <option>ุดููู</option>
    <option>ุงูู</option>
    <option>ุซุงูู</option>
    <option>ููุงุฆู</option>
  </select>

  <label>ูู ุชุชู ูุฎุงููุชู ุจุณุจุจ:</label>
  <input type="text" id="abs_notPunished" placeholder="ุฃุฏุฎู ุงูุณุจุจ">

  <div class="button-row">
    <button class="btn" onclick="abs_generate()">ุฅูุดุงุก ุงูุฑุณุงูุฉ</button>
    <button class="btn" onclick="abs_copy()">ูุณุฎ</button>
  </div>

  <div id="abs_output" class="output"></div>
</div>

<!-- ================= EXTERNAL VACATION (ุฅุฌุงุฒุฉ ุฎุงุฑุฌูุฉ) ================= -->
<div id="extBox" class="container">
  <h2>โ๏ธูููุฐุฌ ุฅุฌุงุฒุฉ ุฎุงุฑุฌูุฉโ๏ธ</h2>

  <label>ููุน ุงููุนุงููุฉ</label>
  <select id="ext_mode" onchange="ext_toggleMode()">
    <option value="main">ุฅุฌุงุฒุฉ ุฎุงุฑุฌูุฉ</option>
    <option value="record_leave">ุณุฌูุงุช ุงูููุธููู - ุฅุฌุงุฒุฉ ุฎุงุฑุฌูุฉ</option>
    <option value="record_break">ุณุฌูุงุช ุงูููุธููู - ูุณุฑ ุงูุงุฌุงุฒุฉ ุงูุฎุงุฑุฌูุฉ</option>
  </select>

  <label>ุงูุงุฌุงุฒุฉ ูููุ</label>
  <select id="ext_personType">
    <option value="ููู">ููู</option>
    <option value="ูุดุฑู">ูุดุฑู</option>
  </select>

  <label>ุงูููุจู ุงูุฏู</label>
  <input type="number" id="ext_copyId" placeholder="ุฃุฏุฎู ุงูููุจู ุงูุฏู">

  <div id="ext_mainFields">
    <label>ูุฏุฉ ุงูุงุฌุงุฒุฉ (ุจุงูุฃูุงู)</label>
    <input type="number" id="ext_days" placeholder="ุนุฏุฏ ุงูุฃูุงู">
  </div>

  <div id="ext_recordLeaveFields" style="display:none">
    <label>ูุฏุฉ ุงูุงุฌุงุฒุฉ (ุจุงูุฃูุงู)</label>
    <input type="number" id="ext_rec_days" placeholder="ุนุฏุฏ ุงูุฃูุงู">

    <label>ุชุงุฑูุฎ ุจุฏุก ุงูุงุฌุงุฒุฉ</label>
    <input type="date" id="ext_rec_start">

    <label>ุชุงุฑูุฎ ุงูุชูุงุก ุงูุงุฌุงุฒุฉ (ููุญุณุจ ุชููุงุฆูุงู)</label>
    <input type="text" id="ext_rec_end" placeholder="ูุชู ุญุณุงุจู ูู ุชุงุฑูุฎ ุงูุจุฏุก + ุงููุฏุฉ" readonly>

    <label>ุฑุงุจุท ุงูุงุฌุงุฒุฉ</label>
    <input type="text" id="ext_rec_link" placeholder="ุถุน ุฑุงุจุท ุงูุงุฌุงุฒุฉ ููุง">
  </div>

  <div id="ext_breakFields" style="display:none">
    <label>ุชุงุฑูุฎ ูุณุฑ/ุฑุฌูุน ูู ุงูุงุฌุงุฒุฉ</label>
    <input type="date" id="ext_break_date">

    <label>ุฑุงุจุท ุงูุงุฌุงุฒุฉ</label>
    <input type="text" id="ext_break_link" placeholder="ุถุน ุฑุงุจุท ุงูุงุฌุงุฒุฉ ููุง">
  </div>

  <div class="button-row">
    <button class="btn" onclick="ext_generate()">ุฅูุดุงุก</button>
    <button class="btn" onclick="ext_copy()">ูุณุฎ</button>
  </div>

  <div id="ext_output" class="output"></div>
</div>

<!-- ================= ROLE REQUEST (ุทูุจ ุฑูู) ================= -->
<div id="roleBox" class="container">
  <h2>๐งพ ุทูุจ ุฑูู ๐งพ</h2>

  <label>ุงูููุจู ุงูุฏู</label>
  <input type="number" id="role_copyId" placeholder="ุฃุฏุฎู ุงูููุจู ุงูุฏู">

  <label>ููุน ุงูุทูุจ</label>
  <div class="checkbox-group" id="role_requests">
    <label><input type="checkbox" value="ุงุฒุงูุฉ ุงูุงุณู"> ุงุฒุงูุฉ ุงูุงุณู</label>
    <label><input type="checkbox" value="ุงุฒุงูู ุฑููุงุช ุงููููุงููู"> ุงุฒุงูู ุฑููุงุช ุงููููุงููู</label>
    <label><input type="checkbox" value="ููุน ุชูุธูู 14 ููู"> ููุน ุชูุธูู 14 ููู</label>
    <label><input type="checkbox" value="ุฅุนุทุงุก ุฑูู ุงุฌุงุฒู ูุธูููุฉ"> ุฅุนุทุงุก ุฑูู ุงุฌุงุฒู ูุธูููุฉ</label>
    <label><input type="checkbox" value="ุงุฒุงูุฉ ุฑูู ุงุฌุงุฒุฉ ุฎุงุฑุฌูุฉ"> ุงุฒุงูุฉ ุฑูู ุงุฌุงุฒุฉ ุฎุงุฑุฌูุฉ</label>
  </div>

  <label>ุงูุณุจุจ</label>
  <input type="text" id="role_reason" placeholder="ูุชู ูุชุงุจุฉ ุงูุณุจุจ ููุง ูุซุงู (ุงุณุชูุงูู ุจุฑุชุจุฉ ูุชุฏุฑุจ)">

  <div class="button-row">
    <button class="btn" onclick="role_generate()">ุฅูุดุงุก ุงูุทูุจ</button>
    <button class="btn" onclick="role_copy()">ูุณุฎ</button>
  </div>

  <div id="role_output" class="output"></div>
</div>

<!-- ================= TICKET TEMPLATES (ููุงุฐุฌ ุงูุชูุงุช) ================= -->
<div id="ticketBox" class="container">
  <h2>๐ซ ููุงุฐุฌ ุงูุชูุงุช ๐ซ</h2>

  <label>ุงุฎุชุฑ ุงููููุฐุฌ</label>
  <select id="ticket_type" onchange="ticket_toggleFields()">
    <option value="">ุงุฎุชุฑ ูููุฐุฌ</option>
    <option value="accept_vac">ูููุฐุฌ ูุจูู ุงูุงุฌุงุฒุฉ</option>
    <option value="vac_form">ูููุฐุฌ ุงูุงุฌุงุฒุฉ</option>
    <option value="resign_form">ูููุฐุฌ ุงูุงุณุชูุงูุฉ</option>
    <option value="promo_form">ูููุฐุฌ ุงูุชุฑููุงุช</option>
  </select>

  <div id="ticket_promoFields" style="display:none">
    <label>ุนุฏุฏ ุงูุชูุงุฑูุฑ</label>
    <input type="number" id="ticket_reports" placeholder="ุงูุชุจ ุนุฏุฏ ุงูุชูุงุฑูุฑ">

    <label>ุนุฏุฏ ุงูุณุงุนุงุช</label>
    <input type="number" id="ticket_hours" placeholder="ุงูุชุจ ุนุฏุฏ ุงูุณุงุนุงุช">

    <label>ุงุณุชุญูุงู ุงูุชุฑููุฉ</label>
    <select id="ticket_eligibility" onchange="ticket_toggleReason()">
      <option value="ูุณุชุญู">ูุณุชุญู</option>
      <option value="ุบูุฑ ูุณุชุญู">ุบูุฑ ูุณุชุญู</option>
    </select>

    <div id="ticket_reasonBox" style="display:none">
      <label>ุงูุณุจุจ</label>
      <input type="text" id="ticket_reason" placeholder="ุงูุชุจ ุงูุณุจุจ ููุง">
    </div>
  </div>

  <div class="button-row">
    <button class="btn" onclick="ticket_generate()">ุฅูุดุงุก</button>
    <button class="btn" onclick="ticket_copy()">ูุณุฎ</button>
  </div>

  <div id="ticket_output" class="output"></div>
</div>

<script>
/* ---------- ูุตุฏุฑ ููุญูุฏ ูุนูุงุตุฑ ุงููุฎุงููุงุช ---------- */
const VIOLATIONS = [
  "ุงูุชูุฑุจ ูู ุงููุญุงุณุจุฉ",
  "ุงุณุชุฎุฏุงู ุฎูุงุต ุงููููุงููู ูููุตูุญุฉ ุงูุดุฎุตูุฉ",
  "ุนุฏู ุงุญุชุฑุงู  ุงููููุงูููู ุงู ุงูููุงุฏุฉ ุงู ุงููุดุฑู",
  "ุงุณุชูุงูู ุจุฑุชุจุฉ ูุณุชูู ูุชุฏุฑุจ ุงู ูุณุชูู 1",
  "ุงุซุงุฑู ุงูุฌุฏู ุจุงูุดุงุช ุงูุนุงู ุงู ุฑุณุงุฆู ุงููููุงููู",
  "ุฃู ุชูุงุนุจ ุจุงูููุงุชูุฑ",
  "ุงุณุชุฎุฑุงุฌ ูุฑูุจุงุช ุงู ุงุณุชุฆุฌุงุฑ ุฏุจุงุจ ุจูุฏู ุงูุญุฌุฒ",
  "ุงูุงุฌุฑุงู ุจูุธููุฉ ุงููููุงููู",
  "ุชูุงุฌุฏ ูู ูุฏู ุงุฎุฑุง",
  "ุงูุฎุฑูุฌ ูู ุบุฑูุฉ ุงูุนูููุงุช ุฏูู ุชุณููู ูุฌููุน ุงูููุงู ุงูููุฏุงููุฉ ( ุงูุนูููุงุช + ุงููุงุฆุจ + ุงูุงุชุตุงูุงุช)",
  "ุฏุฎูู ููุฌู ุงูุฑูุงุจุฉ ูุงูุชูุชูุด",
  "ุงูุณุฌู ุงูุฑูุงุจู",
  "ุนุฏู ุงุญุชุฑุงู ุงูุฑุงุฏ ุงููุทุงุนุงุช ู ุงูููุงุทููู - ุงูุชูุฑุจ ูู ุชูุจููุงุช ุงููุดุฑู",
  "ุงูุชุตุฏูู ุงููุชุนูุฏ ูุบุฑุถ ุชุนุฏูู ุงููุฑูุจู",
  "ุนุฏู ุงูุฌุฏูุฉ ุจุงูููุฏุงู",
  "ุชุฎุทู ูุฑุงุฌุน",
  "ุญูุงุฒู ุณูุงุญ ุงู ููููุนุงุช",
  "ูุฎุงููุงุช ุงูุชุนุฏูู ู ุงูุชุฒููุฏ",
  "ุชุนุฏูู ู ุชุฒููุฏ ุงููุฑูุจุงุช ุงูุชู ุชููู ุงูุณุณูุงุฑุงุช ุฃู ุฃูุณุชุฑุง ุงุณูุญุฉ",
  "ูุญุต ุงู ุชุนุฏูู ู ุชุฒููุฏ ุงููุฑูุจุงุช ูู ุฎุงุฑุฌ ุงููุงุช ุงูุงูุชุชุงุญ",
  "ุงูุชูุงุนุจ ูู ูุณุงุฑุงุช ุงูุชุนุฏูู ู ุงูุชุฒููุฏ",
  "ูุฎุงููุฉ ููุงููู ุงูุชุนุฏูู ู ุงูุชุฒููุฏ (ุชุนุฏูู ูุฑูุจุฉ ุจุฏูู ุชูุฌูู)",
  "ูุฎุงููุฉ ููุงููู ุงูุชุนุฏูู ู ุงูุชุฒููุฏ",
  "ูุฎุงููุฉ ููุงููู ุงูุชุนุฏูู ู ุงูุชุฒููุฏ (ุนุฏู ูุฑุงุฌุนุฉ ุงูุชูุฑูุฑ ุจุนุฏ ุงุฑุณุงูู )",
  "ุชุนุฏูู ู ุชุฒููุฏ ุงููุฑูุจุฉ ุงูุฎุงุตู ุจู ุงููููุฏุณ ุจููุณู",
  "ุงูุตูุน ุงู ุงูุถุฑุจ",
  "ุงูุงูุชุฏุงุจ ููุช ุงูุชูุธูู",
  "ุฏุฎูู ุฑูู ุงููุงุฏุฑ ุงููุณุงุฆู",
  "ุงูุชุฏุฎู ูู ุงูุดุคูู ุงูุฃุฏุงุฑูู",
  "ุชุนุฏูู ุงูุฒู ุงูุฑุณูู ูููุทุงุน ุงู ุงุถุงูู ุงููุดูู",
  "ุงูุงุนุชุฑุงุถ ุนูู ุงูุชุฑููุฉ ุงู ูุฎุงููุฉ ุจุฏูู ุงูุชุญูู ูู ุงููุงู ุงูุดุฑูุท",
  "ูุชุญ ุชูุช ุงุฌุงุฒุฉ ุบูุฑ ูุทุงุจูุฉ ููุดุฑูุท",
  "ุงูุชุงุฎุฑ ูู ุงูุนูุฏุฉ ูู ุงูุงุฌุงุฒุฉ ุงูุฏุงุฎููุฉ",
  "ุชุบููุฑ ุงููุธููุฉ ูุจู ุงุจุชุฏุงุก ุงูุงุฌุงุฒุฉ ุงูุฏุงุฎููุฉ",
  "ุงูุชูุฑุจ ูู ุงุณุชูุงู ููุงู ุงูุนูููุงุช ุงู ูุงุฆุจ ุงูุนูููุงุช ุงู ูุฑูุฒ ุงูุงุชุตุงูุงุช",
  "ุงูุฒุงู ุงูุณุทุญุฉ ุงุซูุงุก ุงูููุงุฏุฉ",
  "ุงุตูุงุญ ุงููุฑูุจุงุช ูู ุฎูุงู ูุงุฆูุฉ F6 ( ุจุฅุณุชุซูุงุก ุงููุฑูุจุงุช ุงูุญููููุฉ )",
  "ุชุฑู ุงูุจูุงุจุงุช ุงููุฑุงุฌ ููุชูุญุฉ",
  "ุชุฎุทู ูุฑุงุฌุน ูู ุงูุฑุงุฏูู",
  "ุงูููุฒ ูู ุงูุฏุฑุฌ ุฏุงุฎู SRT",
  "ุนุฏู ุงูุงุณุชุฌุงุจุฉ ููุงุณุชุฏุนุงุก ูู ูุจู ุงููุดุฑููู ุฎูุงู 24 ุณุงุนุฉ",
  "ุนุฏู ุงุฎุฐ ููุฏ 7 ู ุงูุชุฃููู",
  "ุงูุชุณุทูุญ ุฏุงุฎู ุญุฌุฒ ููุณ ุฏูู ุชูุฌูู",
  "ุงูุชูุฌู ููุฃูุงูู ุงููุญุถูุฑู ุฏูู ุชูุฌูู",
  "ุงูููุงุฏุฉ ุงููุชููุฑุฉ",
  "ุนุฏู ูุทุงุจูุฉ ุงูุงุณู + ุงูุงุณู ูู ูุงูู ุงู",
  "ุงูุชุณุทูุญ ุฏุงุฎู ูุฏุงุก ุงูุงุณุชุบุงุซุฉ",
  "ุงููุงู ูุฑูุจุฉ",
  "ุนุฏู ุงูุงุณุชุฌุงุจุฉ ุนูู ุงูุฑุงุฏูู - ุนุฏู ุชุทุจูู ุชูุฌููุงุช ุงูุนูููุงุช ุงู ุงููุงุฆุจ",
  "ุนุฏู ุงูุงูุชุฒุงู ูู ูุงุฆูุฉ ุงุณุนุงุฑ ุงููุฑุงุฌ",
  "ุงุฎุฐ ููุฏ 7 ู ุนุฏู ุงูุฑุฌูุน ุจุนุฏ ุงูููุช ุงููุญุฏุฏ",
  "ุนุฏู ุชุณุฌูู ุงูุฏุฎูู ูู ุงููุธููุฉ",
  "ุงูุจูุงุก ูู ุฑูู ุงููุฑุงุฌ",
  "ุนุฏู ุฏุฎูู ุงูููุฌุฉ"
];

function populateOptions(panelId){
  const panel = document.getElementById(panelId);
  if(!panel) return;
  panel.innerHTML = '';
  VIOLATIONS.forEach(v=>{
    const div = document.createElement('div');
    div.className = 'cd-option';
    div.textContent = v;
    panel.appendChild(div);
  });
}

/* ---------- UI helpers ---------- */
function show(id){
  document.querySelectorAll('.container').forEach(c=>c.classList.remove('active'));
  const el=document.getElementById(id);
  if(el) el.classList.add('active');
  closeAllDropdowns();
}

/* ---------- custom dropdown behavior ---------- */
function toggleDropdown(name){
  const panel = document.getElementById(name + '_panel');
  const isOpen = panel.style.display === 'block';
  closeAllDropdowns();
  if(!isOpen){
    panel.style.display = 'block';
    panel.setAttribute('aria-hidden','false');
  }
}
function closeAllDropdowns(){
  document.querySelectorAll('.cd-panel').forEach(p=>{
    p.style.display='none';
    p.setAttribute('aria-hidden','true');
  });
}

document.addEventListener('click', function(e){
  if(e.target.closest('#vio_panel') && e.target.classList.contains('cd-option')){
    const val = e.target.innerText.trim();
    document.getElementById('vio_selected').value = val;
    const sel = document.querySelector('#vio_dropdown .cd-selected .placeholder');
    if(sel) sel.innerText = val;
    document.querySelectorAll('#vio_panel .cd-option').forEach(o=>o.classList.remove('selected'));
    e.target.classList.add('selected');
    closeAllDropdowns();
    e.stopPropagation();
    return;
  }
  if(e.target.closest('#abs_panel') && e.target.classList.contains('cd-option')){
    const val = e.target.innerText.trim();
    document.getElementById('abs_selected').value = val;
    const sel = document.querySelector('#abs_dropdown .cd-selected .placeholder');
    if(sel) sel.innerText = val;
    document.querySelectorAll('#abs_panel .cd-option').forEach(o=>o.classList.remove('selected'));
    e.target.classList.add('selected');
    closeAllDropdowns();
    e.stopPropagation();
    return;
  }
  if(!e.target.closest('.custom-dropdown')) closeAllDropdowns();
});
document.addEventListener('keydown', function(e){ if(e.key === 'Escape') closeAllDropdowns(); });

/* ---------- VACATION: toggle ---------- */
function vac_toggleFields(){
  const type = document.getElementById('vac_vacType').value;
  const balanceLabel = document.getElementById('vac_balanceLabel');
  const balanceInput = document.getElementById('vac_balance');
  const leadHeaderBox = document.getElementById('vac_leadHeaderBox');
  const leadHeaderSel = document.getElementById('vac_leadHeader');

  if(type === 'ููุงูุฃุฉ ููุงุฏูุฉ'){
    balanceLabel.textContent = 'ุชูููุน ู ุงุนุชูุงุฏ : ';
    balanceInput.value = '';
    balanceInput.placeholder = 'ุฃุฏุฎู ููุจู ุขูุฏู ุงูููุงุฏุฉ';
    leadHeaderBox.style.display = 'block';
  } else {
    balanceLabel.textContent = 'ุงูุฑุตูุฏ ุงููุชุจูู (ุจุงูุณุงุนุงุช)';
    balanceInput.placeholder = 'ุนุฏุฏ ุงูุณุงุนุงุช';
    leadHeaderBox.style.display = 'none';
    if(leadHeaderSel) leadHeaderSel.value = '';
  }
}

function vac_toggleManualTime(){
  const manual = document.getElementById('vac_manualTime').checked;
  document.getElementById('vac_timeRow').style.display = manual ? 'flex' : 'none';
}

/* ---------- VIOLATIONS: hide fine on "ุดููู" ---------- */
function vio_toggleByLevel(){
  const level = document.getElementById('vio_warningLevel').value;
  const fineRow = document.getElementById('vio_fineRow');
  fineRow.style.display = (level === 'ุดููู') ? 'none' : 'block';
}
vio_toggleByLevel();

/* ---------- VACATION (internal) ---------- */
function vac_generateVacation(){
  const type = document.getElementById('vac_vacType').value;

  const copyId = (document.getElementById('vac_copyId').value || '').trim();
  const duration = parseInt(document.getElementById('vac_duration').value, 10) || 0;
  const balanceRaw = (document.getElementById('vac_balance').value || '').trim();

  if(!copyId || duration <= 0){
    alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงูููุจู ุงูุฏู ูุงููุฏุฉ ุจุดูู ุตุญูุญ"); return;
  }

  const isLeadershipReward = (type === 'ููุงูุฃุฉ ููุงุฏูุฉ');
  if(isLeadershipReward){
    if(!balanceRaw){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ููุจู ููุฒุฑ ุขูุฏู ุงูููุงุฏุฉ"); return; }
    if(!(document.getElementById('vac_leadHeader').value)){ alert('โ๏ธ ูุฑุฌู ุงุฎุชูุงุฑ ุงููุฎุงุทูุจ'); return; }
  } else {
    const balance = parseInt(balanceRaw,10) || 0;
    if(balance <= 0){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงูุฑุตูุฏ ุงููุชุจูู (ุจุงูุณุงุนุงุช) ุจุดูู ุตุญูุญ"); return; }
  }

  const manual = document.getElementById('vac_manualTime').checked;
  let startDate, endDate;

  if(manual){
    let startHour = parseInt(document.getElementById('vac_startHour').value) || 0;
    let startMinute = parseInt(document.getElementById('vac_startMinute').value) || 0;
    const period = document.getElementById('vac_startPeriod').value;

    if(startHour <= 0 || startHour > 12 || startMinute < 0 || startMinute > 59){
      alert("โ๏ธ ุฃุฏุฎู ุณุงุนุฉ ุจูู 1-12 ูุฏูููุฉ ุจูู 0-59"); return;
    }
    if(period === "ู" && startHour < 12) startHour += 12;
    if(period === "ุต" && startHour === 12) startHour = 0;

    let tzDate = new Date(new Date().toLocaleString("en-US", { timeZone: "Asia/Riyadh" }));
    let yyyy = tzDate.getFullYear();
    let mm = String(tzDate.getMonth()+1).padStart(2,'0');
    let dd = String(tzDate.getDate()).padStart(2,'0');

    startDate = new Date(`${yyyy}-${mm}-${dd}T${String(startHour).padStart(2,'0')}:${String(startMinute).padStart(2,'0')}:00`);
    endDate = new Date(startDate); endDate.setHours(endDate.getHours() + duration);
  }else{
    const tzNow = new Date(new Date().toLocaleString("en-US",{timeZone:"Asia/Riyadh"}));
    startDate = new Date(tzNow.getTime() + 5*60*1000);
    endDate = new Date(startDate.getTime() + duration*60*60*1000);
  }

  function formatDate(date){
    let y=date.getFullYear(), m=String(date.getMonth()+1).padStart(2,'0'), d=String(date.getDate()).padStart(2,'0');
    let h=date.getHours(), min=String(date.getMinutes()).padStart(2,'0');
    let per=h>=12?"ู":"ุต"; h=h%12; h=h?h:12;
    return `${y}/${m}/${d}| ${h}:${min}${per}`;
  }

  let titleLine = 'ุฅุฌุงุฒุฉ ุฏุงุฎููุฉ';
  if(type === 'ููุงูุฃุฉ ููุงุฏูุฉ') titleLine = 'ููุงูุฃุฉ ููุงุฏูุฉ';
  else if(type === 'ุฅุฌุงุฒุฉ ูุชููุฒ ุงูุฃุณุจูุน') titleLine = 'ุฅุฌุงุฒุฉ ูุชููุฒ ุงูุฃุณุจูุน';
  else if(type === 'ุฅุฌุงุฒุฉ ุชุงุฌุฑ') titleLine = 'ุฅุฌุงุฒุฉ ุชุงุฌุฑ';

  let headerText = 'ุงูููู ุงููุญุชุฑู';
  if(type === 'ูุดุฑู') headerText = 'ุงููุดุฑู ุงููุญุชุฑู';
  if(isLeadershipReward){
    headerText = document.getElementById('vac_leadHeader').value;
  }

  let topBalanceLine = '';
  if(!isLeadershipReward){
    const balance = parseInt(balanceRaw, 10) || 0;
    topBalanceLine = `***\`ุงูุฑุตูุฏ ุงููุชุจูู :\` ${balance - duration} ุณุงุนุฉ***  \n`;
  }

  let leadershipLine = '';
  if(isLeadershipReward){
    leadershipLine = `\n***\`ุชูููุน ู ุงุนุชูุงุฏ :\` <@${balanceRaw}>***\n`;
  }

  const result =
`***\` ${titleLine} \`*** 

***\`${headerText} :\`***  <@${copyId}>   

***\`ุงููููููุฏุฉ :\` ${duration} ุณุงุนุฉ***  

${topBalanceLine}
***ูู ุชุงุฑูุฎ ${formatDate(startDate)} ***  
***ุงูู ุชุงุฑูุฎ ${formatDate(endDate)} ***  

***\`ููุงุญุธุฉ :\`***  
***ุชูุชูู ุงุฌุงุฒุชู ุจููุณ ุงูุชูููุช ุงููู ุจุชุฑุฌุน ููุฉ .***  

***\`ุชููููุงุช ูุงูุฉ ูุฌุจ ูุฑุงุฆุชูุง :\`***  

***01/ ุชุจุฏุฃ ุงูุฅุฌุงุฒุฉ ุงูุฎุงุตุฉ ุจู ูู ููุชูุง ุงููุญุฏุฏุ ูููููุน ุชุบููุฑ ุงููุธููุฉ ูุจู ุงููุฏุฉ ุงููุญุฏุฏุฉ ูุจุฏุก ุงูุฅุฌุงุฒุฉ.***  

***02/ ูุฌุจ ุงูุนูุฏุฉ ูู ุงูุฅุฌุงุฒุฉ ูุจู ุงูุชูุงุก ูุฏุชูุง ูุชุบููุฑ ุงููุธููุฉ ุฅูู ูุทุงุน ุงููููุงููู. ูู ูุฎุงูู ุฐูู ุณููุนุชุจุฑ ุชูุฑุจุงู ูุธูููุงู ูุณุชุชู ูุญุงุณุจุชู ูู ููุจู ุฅุฏุงุฑุฉ ุงููุฑุงุฌ.***  

***03/ ูู ุญุงู ุนูุฏู ุนุฐุฑ ููุฏูุชู ุจูุชุญ ุชูุช ุงุฌุงุฒุฉ ุณูุชู ููุท ุชุตููุฑ ุงุฌุงุฒุงุชู ูููุง ูุงู ุงูุณุจุจ ูุนุฏู ุงุนุทุงุฆู ุชูุฑุจ ูุธููู***  

***04/ ูู ุญุงู ุชู ุณุฌูู ุฑูุงุจูุง ุณูุชู ุชุทุจูู ุงูุนููุจู ุนููู ุญุณุจ [ููุงููู ุงูุงุฌุงุฒุงุช](https://ptb.discord.com/channels/1071933157097615480/1071934713524133918/1416990256070135900) ***  

***ูุฐูู ูู ุญุงู ุชุนุฏูุช ูุต ุงูุงุณุจูุน ( ุงูุซูุงุซุงุก ) ุงู ูุงู ุฑุตูุฏู ุงูู ูู ูุต ุงุฌูุงููู ุณูุชู ุชุตููุฑู ุงูุงุณุจูุน ุงูุญุงูู ูุงููุงุฏู***  

***05/ูููุน ููุนุงู ุจุงุชุงู ุชุบููุฑ ุงูุงุณู ุฏุงุฎู ุงูููุงุทุนุฉ ุญุณุจ [ููุงููู ุงูุงุฌุงุฒุงุช](https://ptb.discord.com/channels/1071933157097615480/1071934713524133918/1416990256070135900) ***

${leadershipLine}

<@&1149742928953086105>`;
  const out = document.getElementById('vac_output');
  out.innerText = result; out.style.display='block';
}

/* ---------- SECONDMENT (ุงูุงูุชุฏุงุจุงุช) ---------- */
function sec_generate(){
  const copyId = (document.getElementById('sec_copyId').value || '').trim();
  const nameCode = (document.getElementById('sec_nameCode').value || '').trim();
  const sector = document.getElementById('sec_sector').value;
  const days = (document.getElementById('sec_days').value || '').trim();

  if(!copyId || !nameCode || !sector || !days){
    alert("โ๏ธ ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุญููู ุงูุงูุชุฏุงุจุงุช");
    return;
  }

  const result =
`*** โฌโฌโฌ ๏ทฝ โฌโฌ
\`\`\`ุงูููุถูุน : ุงูุชุฏุงุจ ุฎุงุฑุฌู \`\`\`
ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ ูุจุนุฏ:
 \`\`\`cs
# ุฅุดุงุฑุฉ ุฅูู ุทูุจ ุงูููุธู ุงูููุถุญุฉ ุจูุงูุงุชู ุฃุฏูุงู ุจุดุฃู ุงูุงูุชุฏุงุจ ุฎุงุฑุฌ ุงููุฑุงุฌุ ูููุฏูู ุจุฃูู ุชูุช ุงูููุงููุฉ ุนูู ุทูุจู ููู ุงูุชูุงุตูู ุงูุชุงููุฉ:
\`\`\`

 ุงูุงุณู: <@${copyId}>
 ุงุณู ูููุฏ ุงูููุธู : ${nameCode}
 ุงููุทุงุน ุงูููุชุฏุจ ูู: ${sector}
 ุงููุฏุฉ: ${days} ููู

ูุฑุฌูุง ูู ุงูููุธู ุงูุชููุฏ ุจุงูุฃูุธูุฉ ูุงูุชุนูููุงุช ุงูุฎุงุตุฉ ุจุงูุงูุชุฏุงุจุงุชุ ูุงูุชูุณูู ูุน ุงูุฌูุฉ ุงููุนููุฉ ูุจู ุงููุจุงุดุฑุฉ.

<@&1149742928953086105> ***`;
  const out = document.getElementById('sec_output');
  out.innerText = result; out.style.display='block';
}

/* ---------- RESIGNATION ---------- */
function res_toggleLevel(){
  const t = document.getElementById('res_type').value;
  const box = document.getElementById('res_levelBox');
  const label = document.getElementById('res_levelLabel');
  const input = document.getElementById('res_levelNumber');

  if(t === 'ุงุนูู' || t === 'supervisor_4_6' || t === 'retire_7_9'){
    box.style.display = 'block';
    input.value = '';
    if(t === 'ุงุนูู') label.innerText = 'ุฑูู ุงููุณุชูู (2 ูุฃุนูู)';
    if(t === 'supervisor_4_6') label.innerText = 'ุฑูู ุงููุณุชูู (4 - 6)';
    if(t === 'retire_7_9') label.innerText = 'ุฑูู ุงููุณุชูู (7 - 9)';
  } else {
    box.style.display = 'none';
    input.value = '';
  }
}

function res_generate(){
  const type = document.getElementById('res_type').value;
  const copyId = (document.getElementById('res_copyId').value || '').trim();
  const nameCode = (document.getElementById('res_nameCode').value || '').trim();
  const signerId = (document.getElementById('res_supervisorId').value || '').trim();
  const levelRaw = (document.getElementById('res_levelNumber').value || '').trim();
  const levelNum = parseInt(levelRaw,10);

  if(!copyId){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงูููุจู ุงูุฏู"); return; }
  if(!nameCode){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงูุงุณู ู ุงูููุฏ"); return; }
  if(!signerId){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ููุจู ุงูุฏู (ุชูููุน)"); return; }

  if(type === 'supervisor_4_6'){
    if(!levelRaw || isNaN(levelNum) || levelNum < 4 || levelNum > 6){
      alert("โ๏ธ ุฃุฏุฎู ุฑูู ูุณุชูู ุตุญูุญ ุจูู 4 ู 6"); return;
    }
    const result =
`*** โฌโฌโฌ ๏ทฝ โฌโฌ
\`\`\`diff

-ุงูููุถูุน : ูุฑุงุฑ ุงููุงุก ุฎุฏูุงุช
\`\`\`
\`\`\`cs
# ุจุนุฏ ุงูุงุทูุงุน ุนูู ูุธุงู ุงูุชูุธูู ูุงูุชุฑููุงุช ูุงููุงุก ุงูุฎุฏูุฉ ุงูุตุงุฏุฑ ูู ุงุฏุงุฑุฉ ุงููุฑุงุฌ ูุฑุฑูุง ูุงููู 
 
ุฃููุงู:  ุชููู ุฎุฏูุงุช ุงููุดุฑู ุงุฏูุงู ุงุนุชุจุงุฑุง ูู ุชุงุฑูุฎู
\`\`\`

<@${copyId}>
${nameCode}

**ูุดูุฑ ุฌููุฏู ุงููุจุฐููู ููุง ูุฏูู ูููุทุงุน ููุชููู ูู ุงูุชูููู**

\`\`\`ูุฐูู ุจุณุจุจ : ุงุณุชูุงูุฉ ุจุฑุชุจุฉ ูุณุชูู (${levelNum}) ุจูุงุกุงู ุนูู ุทูุจู  \`\`\`


\`ุชูููุน:\`
<@${signerId}>

\`ุงุนุชูุงุฏ:\`
<@&1142626604732915812> 
<@1140931533285367852> 
<@&1092120226478428200> 
\`ูุฑุณู ุงูุงุตู ุงูู : \`
<@&1149742928953086105> ***`;
    const out = document.getElementById('res_output');
    out.innerText = result; out.style.display='block';
    return;
  }

  if(type === 'retire_7_9'){
    if(!levelRaw || isNaN(levelNum) || levelNum < 7 || levelNum > 9){
      alert("โ๏ธ ุฃุฏุฎู ุฑูู ูุณุชูู ุตุญูุญ ุจูู 7 ู 9"); return;
    }
    const result =
`*** โฌโฌโฌ ๏ทฝ โฌโฌ
\`\`\`diff

-ุงูููุถูุน : ูุฑุงุฑ ุงุญุงูุฉ ุงูู ุงูุชูุงุนุฏ ุจูุงุกุงู ุนูู ุทูุจู
\`\`\`
\`\`\`cs
# ุจุนุฏ ุงูุงุทูุงุน ุนูู ูุธุงู ุงูุชูุธูู ูุงูุชุฑููุงุช ูุงููุงุก ุงูุฎุฏูุฉ ุงูุตุงุฏุฑ ูู ุงุฏุงุฑุฉ ุงููุฑุงุฌ ูุฑุฑูุง ูุงููู 
 
ุฃููุงู: ุชููู ุฎุฏูุงุช ุงููุดุฑู ุงุฏูุงู ุจูุงุกุงู ุนูู ุทูุจู ุงุนุชุจุงุฑุง ูู ุชุงุฑูุฎู 
\`\`\`

<@${copyId}>
${nameCode}

**ูุดูุฑ ุฌููุฏู ุงููุจุฐููู ููุง ูุฏูู ูููุทุงุน ููุชููู ูู ุงูุชูููู**

\`\`\`ูุฐูู ุงุญุงูุฉ ุงูู ุงูุชูุงุนุฏ ุจุฑุชุจุฉ ูุณุชูู (${levelNum}) ุจูุงุกุงู ุนูู ุทูุจู \`\`\`


\`ุชูููุน:\`
<@${signerId}>

\`ุงุนุชูุงุฏ:\`
<@&1142626604732915812> 
<@1140931533285367852> 
<@&1092120226478428200> 
\`ูุฑุณู ุงูุงุตู ุงูู : \`
<@&1149742928953086105> ***`;
    const out = document.getElementById('res_output');
    out.innerText = result; out.style.display='block';
    return;
  }

  if(type === 'ูุณุชูู ูุชุฏุฑุจ' || type === 'ูุณุชูู 1'){
    const reasonLine = (type === 'ูุณุชูู ูุชุฏุฑุจ')
      ? "ุงุณุชูุงูุฉ ุจุฑุชุจุฉ ูุณุชูู (ูุชุฏุฑุจ)"
      : "ุงุณุชูุงูุฉ ุจุฑุชุจุฉ ูุณุชูู (1)";

    const result =
`*** โฌโฌโฌ ๏ทฝ โฌโฌ
\`\`\`diff

-ุงูููุถูุน : ูุฑุงุฑ ุงููุงุก ุฎุฏูุงุช
\`\`\`
\`\`\`cs
# ุจุนุฏ ุงูุงุทูุงุน ุนูู ูุธุงู ุงูุชูุธูู ูุงูุชุฑููุงุช ูุงููุงุก ุงูุฎุฏูุฉ ุงูุตุงุฏุฑ ูู ุงุฏุงุฑุฉ ุงููุฑุงุฌ ูุฑุฑูุง ูุงููู 
 
ุงููุงู: ุชููู ุฎุฏูุงุช ุงูููู ุงุฏูุงู ุงุนุชุจุงุฑุง ูู ุชุงุฑูุฎู
ุซุงููุงู: ููุน ุชูุธูู 14 ููู
ุซุงูุซุงู:ุบุฑุงูู ูุงููุฉ ูุฏุฑูุง 1,000,000 ุชุณูู ุงูู ุฎุฒููุฉ ุงููุฑุงุฌ
\`\`\`

<@${copyId}>
${nameCode}

\`\`\`ูุฐูู ุจุณุจุจ : ${reasonLine} \`\`\`

\`ููุน ุงูุณุญุจ : \`  [ูุงุชูุฑุฉ](ุฑุงุจุท ุงููุงุชูุฑุฉ) 

\`ุงุนุชูุงุฏ:\` <@${signerId}>

\`ุชูููุน ูุฏูุฑ ุงูุฎุฒููุฉ: \`
<@1182445629721563177> 
<@&1071933343123386429> 

ูุฑุณู ุงูุงุตู ุงูู : 
<@&1149742928953086105> ***`;
    const out = document.getElementById('res_output');
    out.innerText = result; out.style.display='block';
    return;
  }

  if(type === 'ุงุนูู'){
    if(!levelRaw || isNaN(levelNum) || levelNum < 2){
      alert("โ๏ธ ุฃุฏุฎู ุฑูู ูุณุชูู ุตุงูุญ (2 ูุฃุนูู)"); return;
    }
    const resultHigh =
`*** โฌโฌโฌ ๏ทฝ โฌโฌ
\`\`\`diff

-ุงูููุถูุน : ูุฑุงุฑ ุงููุงุก ุฎุฏูุงุช
\`\`\`
\`\`\`cs
# ุจุนุฏ ุงูุงุทูุงุน ุนูู ูุธุงู ุงูุชูุธูู ูุงูุชุฑููุงุช ูุงููุงุก ุงูุฎุฏูุฉ ุงูุตุฏุฑ ูู ุงุฏุงุฑุฉ ุงููุฑุงุฌ ูุฑุฑูุง ูุงููู 
 
ุงููุงู: ุชููู ุฎุฏูุงุช ุงูููู ุงุฏูุงู ุงุนุชุจุงุฑุง ูู ุชุงุฑูุฎู\`\`\`

<@${copyId}>
${nameCode}

\`\`\`ูุฐูู ุจุณุจุจ : ุงุณุชูุงูุฉ ุจุฑุชุจุฉ ูุณุชูู (${levelNum}) ุจูุงุกุงู ุนูู ุทูุจู \`\`\`

\`ุชูููุน ูุงุนุชูุงุฏ:\`
<@${signerId}>

\`ูุฑุณู ุงูุงุตู ุงูู : \`
<@&1149742928953086105> ***`;
    const out = document.getElementById('res_output');
    out.innerText = resultHigh; out.style.display='block';
    return;
  }
}

/* ---------- NEW: Accredited resignation toggle/generate ---------- */
function acc_toggleLevel(){
  const t = document.getElementById('acc_type').value;
  const box = document.getElementById('acc_levelBox');
  const inp = document.getElementById('acc_levelNumber');
  if(t === 'level_2_3'){
    box.style.display = 'block';
    inp.value = '';
  } else {
    box.style.display = 'none';
    inp.value = '';
  }
}

function acc_generate(){
  const type = document.getElementById('acc_type').value;
  const accId = (document.getElementById('acc_copyId').value || '').trim();
  const nameCode = (document.getElementById('acc_nameCode').value || '').trim();
  const selfId = (document.getElementById('acc_selfId').value || '').trim();
  const permId = (document.getElementById('acc_permissionId').value || '').trim();
  const lvlRaw = (document.getElementById('acc_levelNumber').value || '').trim();
  const lvl = parseInt(lvlRaw,10);

  if(!accId){ alert("โ๏ธ ุฃุฏุฎู ููุจู ุงูุฏู ุงููุนุชูุฏ"); return; }
  if(!nameCode){ alert("โ๏ธ ุฃุฏุฎู ุงุณู ู ููุฏ ุงููุนุชูุฏ"); return; }
  if(!selfId){ alert("โ๏ธ ุฃุฏุฎู ููุจู ุงูุฏู (ููุดู ูููุณู)"); return; }
  if(!permId){ alert("โ๏ธ ุฃุฏุฎู ููุจู ุงูุฏู ูุณุคูู ูู ุงุนุทุงุก ุงูุงุฐู"); return; }

  if(type === 'trainee_1'){
    const result =
`*** โฌโฌโฌ ๏ทฝ โฌโฌ
\`\`\`diff

-ุงูููุถูุน : ูุฑุงุฑ ุงููุงุก ุฎุฏูุงุช ุงููุนุชูุฏ
\`\`\`
\`\`\`cs
# ุจุนุฏ ุงูุงุทูุงุน ุนูู ูุธุงู ุงูุชูุธูู ูุงูุชุฑููุงุช ูุงููุงุก ุงูุฎุฏูุฉ ุงูุตุงุฏุฑ ูู ุงุฏุงุฑุฉ ุงููุฑุงุฌ ูุฑุฑูุง ูุงููู 
 
ุงููุงู: ุชููู ุฎุฏูุงุช ุงููุนุชูุฏ ุงุฏูุงู ุงุนุชุจุงุฑุง ูู ุชุงุฑูุฎู
ุซุงููุงู:ุบุฑุงูู ูุงููุฉ ูุฏุฑูุง 1,000,000 ุชุณูู ุงูู ุฎุฒููุฉ ุงููุฑุงุฌ
\`\`\`

<@${accId}>
${nameCode}

\`\`\`ูุฐูู ุจุณุจุจ : ุงุณุชูุงูุฉ ุจุฑุชุจุฉ ูุณุชูู (ูุชุฏุฑุจ & 1) \`\`\`

\`ููุน ุงูุณุญุจ : \` [ูุงุชูุฑุฉ](ุฑุงุจุท ุงูุฏููู) 

\`ุงุนุชูุงุฏ:\` <@${selfId}>

\`ุงุนุชูุงุฏ ูุฏูุฑ ูุณู ุดุคูู ุงููุนุชูุฏูู:\`
<@571068478753341453> 
<@&1092120390324731994> 

\`ุชูููุน ูุฏูุฑ ุงูุฎุฒููุฉ: \`
<@1182445629721563177> 
<@&1071933343123386429> 

\`ูููุชุงุจุนุฉ:\`
( <@${permId}> )

ูุฑุณู ุงูุงุตู ุงูู : 
<@&1149742928953086105> ***`;
    const out = document.getElementById('acc_output');
    out.innerText = result; out.style.display='block';
    return;
  }

  if(type === 'level_2_3'){
    if(!lvlRaw || isNaN(lvl) || (lvl !== 2 && lvl !== 3)){
      alert("โ๏ธ ุงูุชุจ ุฑูู ูุณุชูู ุตุญูุญ: 2 ุฃู 3 ููุท"); return;
    }

    const result =
`*** โฌโฌโฌ ๏ทฝ โฌโฌ
\`\`\`diff

-ุงูููุถูุน : ูุฑุงุฑ ุงููุงุก ุฎุฏูุงุช ูุนุชูุฏ
\`\`\`
\`\`\`cs
# ุจุนุฏ ุงูุงุทูุงุน ุนูู ูุธุงู ุงูุชูุธูู ูุงูุชุฑููุงุช ูุงููุงุก ุงูุฎุฏูุฉ ุงูุตุงุฏุฑ ูู ุงุฏุงุฑุฉ ุงููุฑุงุฌ ูุฑุฑูุง ูุงููู 
 
ุงููุงู: ุชููู ุฎุฏูุงุช ุงููุนุชูุฏ ุงุฏูุงู ุงุนุชุจุงุฑุง ูู ุชุงุฑูุฎู\`\`\`

<@${accId}>
${nameCode}

\`\`\`ูุฐูู ุจุณุจุจ : ุงุณุชูุงูุฉ ุจุฑุชุจุฉ ูุณุชูู (${lvl}) ุจูุงุกุงู ุนูู ุทูุจู \`\`\`

\`ุชูููุน :\`
<@${selfId}>

\`ุงุนุชูุงุฏ:\`
<@571068478753341453> 
<@&1092120390324731994> 

\`ูููุชุงุจุนุฉ:\`
( <@${permId}> )

\`ูุฑุณู ุงูุงุตู ุงูู : \`
<@&1149742928953086105> ***`;
    const out = document.getElementById('acc_output');
    out.innerText = result; out.style.display='block';
    return;
  }
}

/* ---------- VIOLATIONS (ุงููุฎุงููุงุช) ---------- */
function vio_generate(){
  const copyId = (document.getElementById('vio_copyId').value || '').trim();
  const warningLevel = document.getElementById('vio_warningLevel').value;
  const fineAmount = (document.getElementById('vio_fineAmount')?.value || '').trim();
  const violation = document.getElementById('vio_selected').value || '';
  const supervisorId = (document.getElementById('vio_supervisorId')?.value || '').trim();

  if(!copyId){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงูููุจู ุงูุฏู"); return; }
  if(!violation){ alert("โ๏ธ ูุฑุฌู ุงุฎุชูุงุฑ ุณุจุจ ุงููุฎุงููุฉ"); return; }
  if(!supervisorId){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ููุจู ุงูุฏู ุงููุดุฑู"); return; }

  if(warningLevel === 'ุดููู'){
    const resultShafahi =
`โฌโฌโฌ ๏ทฝ โฌโฌ
\`\`\`diff

-ุงูููุถูุน : ุงูุฐุงุฑ (ุดููู) 
\`\`\`
\`\`\`cs
# ุจุนุฏ ุงูุงุทูุงุน ุนูู ูุธุงู ุงููุฎุงููุงุช ูุงูุนููุจุงุช ุงูุตุงุฏุฑ ูู ุงุฏุงุฑุฉ ุงููุฑุงุฌ ูุฑุฑูุง ูุงููู 
 
ุงููุงู: ุงูุฐุงุฑ (ุดููู) 
\`\`\`

\` ุงูููู : \` <@${copyId}>

\`\`\`ูุฐูู ุจุณุจุจ :  ${violation}\`\`\`

\`ุงุนุชูุงุฏ:\` <@${supervisorId}>`;
    const out = document.getElementById('vio_output');
    out.innerText = resultShafahi; out.style.display='block';
    return;
  }

  if(!fineAmount){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ูููุฉ ุงูุบุฑุงูุฉ"); return; }

  const result =
`*** โฌโฌโฌ ๏ทฝ โฌโฌ
\`\`\`diff

-ุงูููุถูุน : ุงูุฐุงุฑ ูุธููู ูุบุฑุงูู ูุงููุฉ
\`\`\`
\`\`\`cs
# ุจุนุฏ ุงูุงุทูุงุน ุนูู ูุธุงู ุงููุฎุงููุงุช ูุงูุนููุจุงุช ุงูุตุงุฏุฑ ูู ุงุฏุงุฑุฉ ุงููุฑุงุฌ ูุฑุฑูุง ูุงููู 
 
ุงููุงู: ุงูุฐุงุฑ ูุธููู (${warningLevel})
ุซุงููุงู: ุบุฑุงูู ูุงููุฉ ูุฏุฑูุง ${fineAmount} ุชุณูู ุงูู ุฎุฒููุฉ ุงููุฑุงุฌ\`\`\`

<@${copyId}>

\`\`\`ูุฐูู ุจุณุจุจ : ${violation}\`\`\`

\`ููุน ุงูุณุญุจ : \`  [ูุงุชูุฑุฉ](ุฑุงุจุท ุงููุงุชูุฑุฉ) 

\`ุงุนุชูุงุฏ:\` <@${supervisorId}>

\`ุชูููุน ูุฏูุฑ ุงูุฎุฒููุฉ \`
<@1182445629721563177> 
<@&1071933343123386429> 

ูุฑุณู ุงูุงุตู ุงูู : 
<@&1149742928953086105> ***`;
  const out = document.getElementById('vio_output');
  out.innerText = result; out.style.display='block';
}

/* ---------- ABSENT (ููู ูู ูุญุถุฑ) ---------- */
function abs_generate(){
  const copyId = (document.getElementById('abs_copyId').value || '').trim();
  const reason = document.getElementById('abs_selected').value || '';
  const penalty = (document.getElementById('abs_penalty').value || '').trim();
  const warning = document.getElementById('abs_warning').value;
  const notPunished = (document.getElementById('abs_notPunished').value || '').trim();

  if(!copyId || !reason || !penalty || !warning){
    alert("ูุฑุฌู ููุก ุฌููุน ุงูุญููู ุงููุทููุจุฉ"); return;
  }

  const resultText =
`***\`  ูููุฐุฌ ุฅุณุชุฏุนุงุก ููููู ุงูุฐู ูู ูุญุถุฑ  \`***

***\`ุงุณู ุงูููู : \` <@${copyId}> ***

***\`ุณุจุจ ุงูุงุณุชุฏุนุงุก : \` ${reason} ***

***\`ูููุฉ ุงููุฎุงููุฉ : \` ${Number(penalty).toLocaleString()} ***

***\` ุงูุงูุฐุงุฑ ุงููุณุชุญู ุ :\` ${warning} *** 

***\`ูู ุชุชู ูุฎุงููุชู ุจุณุจุจ :\` ${notPunished} ***

***ุงูู ูุฌูู ุงูููู ูุนููู ุณุจุจ ุงููุฎุงููุฉ  ูููุฒูู ุงููุฎุงููุฉ ูู ุฑูู
https://ptb.discord.com/channels/1071933157097615480/1071934723858894868 ***  

***ูุณุฎู ุงูู***
 <@&1071933357136556183>  - <@&1142626431101325403>`;
  const out = document.getElementById('abs_output');
  out.innerText = resultText; out.style.display='block';
}

/* ---------- EXTERNAL VACATION (ุฅุฌุงุฒุฉ ุฎุงุฑุฌูุฉ) ---------- */
function ext_toggleMode(){
  const mode = document.getElementById('ext_mode').value;
  const mainFields = document.getElementById('ext_mainFields');
  const recLeave = document.getElementById('ext_recordLeaveFields');
  const breakFields = document.getElementById('ext_breakFields');

  if(mode === 'main'){
    mainFields.style.display = 'block';
    recLeave.style.display = 'none';
    breakFields.style.display = 'none';
  } else if(mode === 'record_leave'){
    mainFields.style.display = 'none';
    recLeave.style.display = 'block';
    breakFields.style.display = 'none';
  } else {
    mainFields.style.display = 'none';
    recLeave.style.display = 'none';
    breakFields.style.display = 'block';
  }
}

function formatDateYMD(dateStr){
  if(!dateStr) return '';
  const parts = dateStr.split('-');
  if(parts.length !== 3) return dateStr;
  return `${parts[0]}/${parts[1]}/${parts[2]}`;
}

function calcExtRecordEndValue(startStr, days){
  if(!startStr || !days || days <= 0) return '';
  const parts = startStr.split('-');
  if(parts.length !== 3) return '';
  const y = parseInt(parts[0],10);
  const m = parseInt(parts[1],10)-1;
  const d = parseInt(parts[2],10);
  if(isNaN(y) || isNaN(m) || isNaN(d)) return '';
  const date = new Date(y, m, d);
  date.setDate(date.getDate() + days);
  const yyyy = date.getFullYear();
  const mm = String(date.getMonth()+1).padStart(2,'0');
  const dd = String(date.getDate()).padStart(2,'0');
  return `${yyyy}-${mm}-${dd}`;
}

function calcExtRecordEnd(){
  const days = parseInt(document.getElementById('ext_rec_days').value,10);
  const startStr = document.getElementById('ext_rec_start').value;
  const endInput = document.getElementById('ext_rec_end');
  const val = calcExtRecordEndValue(startStr, days);
  endInput.value = val || '';
}

function autoTodayOnFocus(id){
  const el = document.getElementById(id);
  if(!el) return;
  el.addEventListener('focus', ()=>{
    if(el.value) return;
    const now = new Date();
    const yyyy = now.getFullYear();
    const mm = String(now.getMonth()+1).padStart(2,'0');
    const dd = String(now.getDate()).padStart(2,'0');
    el.value = `${yyyy}-${mm}-${dd}`;
  });
}

function ext_generate(){
  const mode = document.getElementById('ext_mode').value;
  const personType = document.getElementById('ext_personType').value; // ููู / ูุดุฑู
  const copyId = (document.getElementById('ext_copyId').value || '').trim();

  if(!copyId){
    alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงูููุจู ุงูุฏู");
    return;
  }

  if(mode === 'main'){
    const headerText = (personType === 'ูุดุฑู') ? 'ุงููุดุฑู ุงููุญุชุฑู' : 'ุงูููู ุงููุญุชุฑู';
    const days = parseInt(document.getElementById('ext_days').value,10);
    if(!days || days <= 0){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงููุฏุฉ ุจุงูุฃูุงู ุจุดูู ุตุญูุญ"); return; }

    let tzDate = new Date(new Date().toLocaleString("en-US", { timeZone: "Asia/Riyadh" }));
    let startDate = new Date(tzDate.getFullYear(), tzDate.getMonth(), tzDate.getDate());
    let endDate = new Date(startDate); endDate.setDate(endDate.getDate() + days);

    function fmtYMD(d){
      let y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,'0'), day=String(d.getDate()).padStart(2,'0');
      return `${y}/${m}/${day}`;
    }

    const result =
`***\`  ุฅุฌุงุฒุฉ ุฎุงุฑุฌูุฉ  \`***  

***\`${headerText} :\`***    <@${copyId}>         

***\`ุงููููููุฏุฉ :\` ${days} ููู***
 
***ูู ุชุงุฑูุฎ ${fmtYMD(startDate)}*** 
*** ุงูู ุชุงุฑูุฎ ${fmtYMD(endDate)}*** 

***\`ููุงุญุธุฉ :\`***

***ุชูุชูู ุงุฌุงุฒุชู ุงูุฎุงุฑุฌูุฉ ูู ููุณ ููู ุงูุชูุงุก ุงูุงุฌุงุฒุฉ.***

***\`ุชููููุงุช ูุงูุฉ ูุฌุจ ูุฑุงุฆุชูุง :\`***

***01/ ูู ุญุงู ุจุฏุช ุงูุงุฌุงุฒุฉ ูููุน ููุนุง ุจุงุชุง ุฏุฎููู ููููุงุทุนุฉ. ูู ูุฎุงูู ุฐูู ุณููุนุชุจุฑ ุชูุฑุจุงู ูุธูููุงู ูุณุชุชู ูุญุงุณุจุชู ูู ููุจู ุฅุฏุงุฑุฉ ุงููุฑุงุฌ.***

***02/ ูู ุญุงู ุงูุชูุงุก ุงูุงุฌุงุฒุฉ ุงู ุงุฑุฏุช ูุทุนูุง ูุฌุจ ูุชุญ ุชูุช ุงุฌุงุฒุฉ ูุทูุจ ูุทุนูุง ุงู ุงููุงุฆูุง ููููุน ุงููุจุงุดุฑุฉ ุญุชู ุงุฒุงูุฉ ุฑูู ุงุฌุงุฒุฉ ูุธูููุฉ***
 
<@&1149742928953086105>`;
    const out = document.getElementById('ext_output');
    out.innerText = result; out.style.display='block';
    return;
  }

  if(mode === 'record_leave'){
    const days = parseInt(document.getElementById('ext_rec_days').value,10);
    const start = document.getElementById('ext_rec_start').value;
    const link  = (document.getElementById('ext_rec_link').value || '').trim();

    if(!days || days <= 0){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ูุฏุฉ ุงูุงุฌุงุฒุฉ ุจุดูู ุตุญูุญ"); return; }
    if(!start){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุชุงุฑูุฎ ุจุฏุก ุงูุงุฌุงุฒุฉ"); return; }
    if(!link){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุฑุงุจุท ุงูุงุฌุงุฒุฉ"); return; }

    const endStr = calcExtRecordEndValue(start, days);
    if(!endStr){ alert("โ๏ธ ุชุนุฐุฑ ุญุณุงุจ ุชุงุฑูุฎ ุงูุชูุงุก ุงูุงุฌุงุฒุฉ"); return; }
    document.getElementById('ext_rec_end').value = endStr;

    const startText = formatDateYMD(start);
    const endText = formatDateYMD(endStr);

    if(personType === 'ููู'){
      const result =
`***\`ูููุฐุฌ ุงูุงุฌุงุฒุฉ ุงูุฎุงุฑุฌูุฉ \`***

***\`ุงุณู ุงูููู  :\`  ( <@${copyId}> ) ***

***\`ูุฏุฉ ุงูุงุฌุงุฒุฉ : \` ( ${days} ููู ) ***

***\`ุชุงุฑูุฎ ุจุฏุก ุงูุงุฌุงุฒุฉ :\` ( ${startText} ) *** 

***\`ุชุงุฑูุฎ ุงูุชูุงุก ุงูุงุฌุงุฒุฉ  :\` ( ${endText} ) *** 

***\`ูุณุฎุฉ ูููุฑุงุฑ :\` ( ${link} ) ***

***\`ููุนูู ูุงูุงุญุงุทุฉ/\`***
<@1059976190988910772> & <@818887908265033728>`;
      const out = document.getElementById('ext_output');
      out.innerText = result; out.style.display='block';
      return;
    }

    const resultSupervisor =
`***\`ูููุฐุฌ ุงูุงุฌุงุฒุฉ ุงูุฎุงุฑุฌูุฉ \`***

***\`ุงุณู ุงููุดุฑู  :\` ( <@${copyId}> ) ***

***\`ูุฏุฉ ุงูุงุฌุงุฒุฉ :\` ( ${days} ููู ) ***

***\`ุชุงุฑูุฎ ุจุฏุก ุงูุงุฌุงุฒุฉ :\` ( ${startText} ) ***

***\`ุชุงุฑูุฎ ุงูุชูุงุก ุงูุงุฌุงุฒุฉ :\` ( ${endText} ) ***

***\`ูุณุฎุฉ ูููุฑุงุฑ :\` ( ${link} ) ***

***\`ููุนูู ูุงูุงุญุงุทุฉ/\`***
<@1140931533285367852>&<@818887908265033728>`;
    const out = document.getElementById('ext_output');
    out.innerText = resultSupervisor; out.style.display='block';
    return;
  }

  if(mode === 'record_break'){
    const breakDate = document.getElementById('ext_break_date').value;
    const link  = (document.getElementById('ext_break_link').value || '').trim();

    if(!breakDate){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุชุงุฑูุฎ ูุณุฑ/ุฑุฌูุน ูู ุงูุงุฌุงุฒุฉ"); return; }
    if(!link){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุฑุงุจุท ุงูุงุฌุงุฒุฉ"); return; }

    const breakText = formatDateYMD(breakDate);

    if(personType === 'ููู'){
      const result =
`***\`ูููุฐุฌ ูุณุฑ / ุฑุฌูุน ูู ุงูุงุฌุงุฒุฉ ุงูุฎุงุฑุฌูุฉ \`***

***\`ุงุณู ุงูููู  :\`***  ***( <@${copyId}> ) ***

***\`ุชุงุฑูุฎ ูุณุฑ/ุฑุฌูุน ูู ุงูุงุฌุงุฒุฉ :\`*** *** ( ${breakText} ) ***

***\`ูุณุฎุฉ ูููุฑุงุฑ :\`*** *** ( ${link} ) ***

***\`ููุนูู ูุงูุงุญุงุทุฉ/\`***
<@1059976190988910772> & <@792640279684710412> & <@1069596605080162397>`;
      const out = document.getElementById('ext_output');
      out.innerText = result; out.style.display='block';
      return;
    }

    const resultSupervisor =
`***\`ูููุฐุฌ ูุณุฑ / ุฑุฌูุน ูู ุงูุงุฌุงุฒุฉ ุงูุฎุงุฑุฌูุฉ \`***

***\`ุงุณู ุงููุดุฑู  :\` ( <@${copyId}> ) ***

***\`ุชุงุฑูุฎ ูุณุฑ/ุฑุฌูุน ูู ุงูุงุฌุงุฒุฉ :\` ( ${breakText} ) ***

***\`ูุณุฎุฉ ูููุฑุงุฑ :\` ( ${link} ) ***

***\`ููุนูู ูุงูุงุญุงุทุฉ/\`***
<@1140931533285367852>&<@818887908265033728>`;
    const out = document.getElementById('ext_output');
    out.innerText = resultSupervisor; out.style.display='block';
    return;
  }
}

/* ---------- ROLE REQUEST (ุทูุจ ุฑูู) ---------- */
function role_generate(){
  const copyId = (document.getElementById('role_copyId').value || '').trim();
  const reason = (document.getElementById('role_reason').value || '').trim();
  const checks = document.querySelectorAll('#role_requests input[type="checkbox"]:checked');

  if(!copyId){ alert("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงูููุจู ุงูุฏู"); return; }
  if(checks.length === 0){ alert("โ๏ธ ูุฑุฌู ุงุฎุชูุงุฑ ููุน ุงูุทูุจ ูุงุญุฏ ุนูู ุงูุฃูู"); return; }
  if(!reason){ alert("โ๏ธ ูุฑุฌู ูุชุงุจุฉ ุงูุณุจุจ"); return; }

  const types = Array.from(checks).map(c=>c.value).join(" , ");

  const result =
`***ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชู ,,***

***\`ุงูููุงุฏุฉ ุงููููุฑุฉ ูุทูุจ ูููู ููููู : \` ( <@${copyId}> ) ***

***ููุน ุงูุทูุจ : ( ${types} ) ***

***\`ูุฐูู ุจุณุจุจ :\` ( ${reason} ) ***

*** ููุนูู ูุน ุงูุชุญูุฉ /***
<@&1071933343123386429> 
<@&1092120226478428200> 
<@&1092120390324731994>***`;

  const out = document.getElementById('role_output');
  out.innerText = result;
  out.style.display = 'block';
}

/* ================= Ticket Templates ================= */
function ticket_toggleFields(){
  const t = document.getElementById('ticket_type').value;
  const promo = document.getElementById('ticket_promoFields');
  if(promo) promo.style.display = (t === 'promo_form') ? 'block' : 'none';
  ticket_toggleReason();
}

function ticket_toggleReason(){
  const t = document.getElementById('ticket_type').value;
  const elig = document.getElementById('ticket_eligibility');
  const box = document.getElementById('ticket_reasonBox');
  if(!box) return;
  if(t !== 'promo_form'){ box.style.display = 'none'; return; }
  box.style.display = (elig && elig.value === 'ุบูุฑ ูุณุชุญู') ? 'block' : 'none';
}

function ticket_generate(){
  const type = document.getElementById('ticket_type').value;
  const out = document.getElementById('ticket_output');
  if(!type){ alert("โ๏ธ ุงุฎุชุฑ ูููุฐุฌ"); return; }

  let result = "";

  if(type === "accept_vac"){
    result =
`***  ูุจูู ุงูุงุฌุงุฒุฉ ุชุญุช ูุฐู ุงูุดุฑูุท :***

**ุชู ูุจูู ุงุฌุงุฒุชู ูุฑุฌูุง ููู ุงูุงูุชุธุงุฑ ูุญูู ุงูุฒุงููุง ูู [ุตุงุฏุฑ ุงูุดุคูู ุงูุงุฏุงุฑูุฉ](https://discord.com/channels/1071933157097615480/1152470303507755008) . **

\`** ูุฑุฌูุง ููู ุงูุงุชุฒุงู ุจุฌููุน ููุงููู ุงูููุงุทุนุฉ ู ูุฑุงุฆุฉ ุงูุงุชู :**\`

***\`ุชููููุงุช ูุงูุฉ ูุฌุจ ูุฑุงุฆุชูุง :\`***  

**01/ ุชุจุฏุฃ ุงูุฅุฌุงุฒุฉ ุงูุฎุงุตุฉ ุจู ูู ููุชูุง ุงููุญุฏุฏุ ูููููุน ุชุบููุฑ ุงููุธููุฉ ูุจู ุงููุฏุฉ ุงููุญุฏุฏุฉ ูุจุฏุก ุงูุฅุฌุงุฒุฉ.**  

**02/ ูุฌุจ ุงูุนูุฏุฉ ูู ุงูุฅุฌุงุฒุฉ ูุจู ุงูุชูุงุก ูุฏุชูุง ูุชุบููุฑ ุงููุธููุฉ ุฅูู ูุทุงุน ุงููููุงููู. ูู ูุฎุงูู ุฐูู ุณููุนุชุจุฑ ุชูุฑุจุงู ูุธูููุงู ูุณุชุชู ูุญุงุณุจุชู ูู ููุจู ุฅุฏุงุฑุฉ ุงููุฑุงุฌ.** 

**03/ ูู ุญุงู ุนูุฏู ุนุฐุฑ ููุฏูุชู ุจูุชุญ ุชูุช ุงุฌุงุฒุฉ ุณูุชู ููุท ุชุตููุฑ ุงุฌุงุฒุงุชู ูููุง ูุงู ุงูุณุจุจ ูุนุฏู ุงุนุทุงุฆู ุชูุฑุจ ูุธููู**  

**04/ ูู ุญุงู ุชู ุณุฌูู ุฑูุงุจูุง ุณูุชู ุชุทุจูู ุงูุนููุจู ุนููู ุญุณุจ [ููุงููู ุงูุงุฌุงุฒุงุช](https://ptb.discord.com/channels/1071933157097615480/1071934713524133918/1416990256070135900) **  

**ูุฐูู ูู ุญุงู ุชุนุฏูุช ูุต ุงูุงุณุจูุน ( ุงูุซูุงุซุงุก ) ุงู ูุงู ุฑุตูุฏู ุงูู ูู ูุต ุงุฌูุงููู ุณูุชู ุชุตููุฑู ุงูุงุณุจูุน ุงูุญุงูู ูุงููุงุฏู**

**05/ูููุน ููุนุงู ุจุงุชุงู ุชุบููุฑ ุงูุงุณู ุฏุงุฎู ุงูููุงุทุนุฉ ุญุณุจ [ููุงููู ุงูุงุฌุงุฒุงุช](https://ptb.discord.com/channels/1071933157097615480/1071934713524133918/1416990256070135900) **`;
  }

  if(type === "vac_form"){
    result =
`> ูููุฐุฌ ุงูุงุฌุงุฒุงุช ูุฑุฌูุง ููู ุชุนุจุฆุชู :
> 
*ูุฑุฌู ููู ุชุนุจุฆุช ูุฐุง ุงููููุฐุฌ ูุทูุจ ุงุฌุงุฒุฉ: *

\`ูุณุชูุงู ูู ุงููููุงููู\` : **ูุณุชูู ....**

\`ุนุฏุฏ ุงูุณุงุนุงุช ุงููุทููุจุฉ \` : **0**

\`ุฑุตูุฏู ุงููุชุจูู ูู ุญุงู ูุฌูุฏู \`: **0**`;
  }

  if(type === "resign_form"){
    result =
`*ุญูุงู ุงููู.*

*- ุชู ูุจูู ุงุณุชูุงูุชู ูุชููู ููู ุงููุงู ูุฐุง ุงูุงุณุชุจูุงู [ุงุถุบุท ููุง](https://forms.cloud.microsoft/r/MRgyvuyWgD).*
*- ูู ุญุงู ููุช ูุณุชูู ูุชุฏุฑุจ ุฃู ูุณุชูู ูุงุญุฏ ูุชูุฌุจ ุงูุชูุงูู 1 ููููู ููุงุณุชูุงูุฉ.*
*- ูู ุญุงู ุงุณุชูุงูุชู ุณูู ุชุญุตู ุนูู ููุน ุชูุถูู ูุฏุชู 14 ููู. *
*- ูุฑุฌูุง ููู ุงูุชูุฌู ุงูู ุฑูู ุงููุฑุงุฌ ูู ุงูุฑุจ ููุช ูุงุณุชููุงู ุงุฌุฑุงุฆุงุช ุงูุงุณุชูุงูุฉ.*
*[ุฑูู ุงููุฑุงุฌ](https://discord.com/channels/1071933157097615480/1202408726925934692)*`;
  }

  if(type === "promo_form"){
    const reports = (document.getElementById('ticket_reports').value || '').trim();
    const hours = (document.getElementById('ticket_hours').value || '').trim();
    const eligibility = document.getElementById('ticket_eligibility').value;
    const reason = (document.getElementById('ticket_reason').value || '').trim();

    const reportsVal = reports ? reports : "0";
    const hoursVal = hours ? hours : "0";

    let reasonLine = "ูุง ููุฌุฏ";
    let reasonsBullets = "";

    if(eligibility === "ุบูุฑ ูุณุชุญู"){
      reasonLine = reason ? reason : "ุงูุณุจุจ ุบูุฑ ูุฐููุฑ";
      reasonsBullets =
`- ุนุฏุฏ ุณุงุนุงุช ุฃูู ูู ุงููุทููุจ .
- ุนุฏุฏ ุชูุงุฑูุฑ ุฃูู ูู ุงููุทููุจ .
-  ููุณ ูุณุชููู ุนุฏุฏ ุงูุฏูุฑุงุช ุงููุทููุจุฉ .`;
    }

    result =
`* ุงุณุชุนูุงู ูุชุทูุจุงุช ุงูุชุฑููุฉ*

\` ุงูุชูุงุฑูุฑ :\` **${reportsVal}**

\`ุนุฏุฏ ุงูุณุงุนุงุช :\`**${hoursVal}**

\`ุงูุฏูุฑุงุช ุงููุชุจููุฉ ููุชุฑููุฉ :\`**ูุงููุฌุฏ**

\`ุงุณุชุญูุงู ุงูุชุฑููุฉ :\`**${eligibility}**
ุงูุงุณุจุงุจ : ${reasonLine}
${reasonsBullets ? ("\n" + reasonsBullets) : ""}`;
  }

  out.innerText = result;
  out.style.display = 'block';
}

/* ===================== COPY HELPERS ===================== */
function copyToClipboard(text){
  if(!text || !text.trim()){
    alert("โ๏ธ ูุง ููุฌุฏ ูุชูุฌุฉ ููุณุฎูุง");
    return;
  }
  if (navigator.clipboard && window.isSecureContext) {
    navigator.clipboard.writeText(text)
      .then(()=>alert("โ ุชู ุงููุณุฎ"))
      .catch(()=>fallbackCopy(text));
  } else {
    fallbackCopy(text);
  }

  function fallbackCopy(t){
    const ta = document.createElement('textarea');
    ta.value = t;
    ta.setAttribute('readonly', '');
    ta.style.position = 'fixed';
    ta.style.top = '-9999px';
    document.body.appendChild(ta);
    ta.select();
    try {
      document.execCommand('copy');
      alert("โ ุชู ุงููุณุฎ");
    } catch (e){
      alert("โ ูู ูุชู ุงููุณุฎ ุชููุงุฆููุง. ุงูุณุฎ ูุฏูููุง.");
    } finally {
      document.body.removeChild(ta);
    }
  }
}

function vac_copyResult(){ copyToClipboard(document.getElementById('vac_output')?.innerText || ""); }
function res_copy(){ copyToClipboard(document.getElementById('res_output')?.innerText || ""); }
function vio_copy(){ copyToClipboard(document.getElementById('vio_output')?.innerText || ""); }
function abs_copy(){ copyToClipboard(document.getElementById('abs_output')?.innerText || ""); }
function ext_copy(){ copyToClipboard(document.getElementById('ext_output')?.innerText || ""); }
function sec_copy(){ copyToClipboard(document.getElementById('sec_output')?.innerText || ""); }
function role_copy(){ copyToClipboard(document.getElementById('role_output')?.innerText || ""); }
function ticket_copy(){ copyToClipboard(document.getElementById('ticket_output')?.innerText || ""); }
function acc_copy(){ copyToClipboard(document.getElementById('acc_output')?.innerText || ""); }

/* ---------- ุนูุฏ ุงูุชุญููู ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  populateOptions('vio_panel');
  populateOptions('abs_panel');
  show('vacBox');          // โ ููุชุญ ุชุงุจ ูุงุญุฏ ููุท
  ext_toggleMode();
  res_toggleLevel();
  ticket_toggleFields();
  acc_toggleLevel();

  const recDaysInput = document.getElementById('ext_rec_days');
  const recStartInput = document.getElementById('ext_rec_start');
  if(recDaysInput) recDaysInput.addEventListener('input', calcExtRecordEnd);
  if(recStartInput) recStartInput.addEventListener('change', calcExtRecordEnd);

  autoTodayOnFocus('ext_rec_start');
  autoTodayOnFocus('ext_break_date');
});
</script>

</body>
</html>
